def availableCpus = Runtime.runtime.availableProcessors()

executor {
    name = 'local'
    cpus = availableCpus
}

process {
    container = 'docker://quay.io/aababc1/metafun:v0.1' 
//'/data1/leehg/program/apptainer/metafun_v0.1.sif'
    apptainer.enabled = true 
}
apptainer {
    enabled = true
    ociAutoPull = false
    cacheDir="${projectDir}/apptainer"
    pullTimeout = 12000000
    //apptainer.autoMounts = true
    //runOptions = '--bind /data2/leehg/OMD3/Generated_pipeline/scratch/tools/microbiome_analysis/scripts:/scratch/tools/microbiome_analysis/scripts  --bind /data2/leehg/OMD3/Generated_pipeline/scratch/tools/microbiome_analysis/database/:/opt/database --bind /data2/leehg/OMD3/Generated_pipeline/scratch/tools/microbiome_analysis/database/humann3/metaphlan:/opt/conda/envs/humann3/lib/python3.10/site-packages/metaphlan/metaphlan_databases --bind /data2/leehg/OMD3/Generated_pipeline/scratch/tools/microbiome_analysis/scripts/make_gene_count_table_ppanggolin205.py:/scratch/tools/microbiome_analysis/scripts/make_gene_count_table_ppanggolin205.py --bind /data2/leehg/OMD3/Generated_pipeline/scratch/tools/microbiome_analysis/scripts/kofam_to_geneID_KO_ppanggolin205.py:/scratch/tools/microbiome_analysis/scripts/kofam_to_geneID_KO_ppanggolin205.py --bind /data2/leehg/OMD3/Generated_pipeline/scratch/tools/microbiome_analysis/scripts/KO_Genome_long2matrix_ppanggolin205.py:/scratch/tools/microbiome_analysis/scripts/KO_Genome_long2matrix_ppanggolin205.py --bind /data2/leehg/OMD3/Generated_pipeline/scratch/tools/microbiome_analysis/scripts/KO_module_visualization_apptainer.R:/scratch/tools/microbiome_analysis/scripts/KO_module_visualization_apptainer.R -W /${USER}_$(uuidgen)'
    // 실제사용가능
    //runOptions = '--bind ${projectDir}/../scripts:/scratch/tools/microbiome_analysis/scripts  --bind ${projectDir}/../database/:/opt/database --bind ${projectDir}/../database/humann3/metaphlan:/opt/conda/envs/humann3/lib/python3.10/site-packages/metaphlan/metaphlan_databases  -W /${USER}_$(uuidgen)'
    runOptions = '--bind ${projectDir}/../scripts:/scratch/tools/microbiome_analysis/scripts  --bind /data2/leehg/OMD3/Generated_pipeline/scratch/tools/microbiome_analysis/database/:/opt/database --bind ${projectDir}/../database/humann3/metaphlan:/opt/conda/envs/humann3/lib/python3.10/site-packages/metaphlan/metaphlan_databases  -W /${USER}_$(uuidgen)'
}
// automatically change this 
